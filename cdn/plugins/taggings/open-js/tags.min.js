(function(a){a.fn.tags=function(c){var b=this.selector;function d(e){var f=[];var g=e.closest(".tags-wrapper").find("li.tag span").each(function(){f.push(a(this).text())});f=f.join(",");e.val(f)}return this.each(function(){var e=this,h=a(this),g=a("<div class='tags-wrapper'><ul></ul></div");tags=h.val(),tagsArray=tags.split(","),$ul=g.find("ul");if(!c){c={}}c.maxSize=50;tagsArray.forEach(function(j){if(j){$ul.append("<li class='tag'><span>"+j+"</span><a href='#'>x</a></li>")}});if(c.classList){g.addClass(c.classList)}$ul.append("<li class='tags-input'><input type='text' class='tags-secret'/></li>");h.after(g);g.append(h);var i=$ul.find("input"),f=parseInt(i.css("font-size"))-4;g.on("click","li.tag a",function(j){j.preventDefault();a(this).closest("li").remove();h.trigger("tagRemove",a(this).closest("li").find("span").text());d(h)});g.on("keydown","li input",function(j){if(j.keyCode==8&&!i.val()){var k=$ul.find("li.tag:last").remove();d(h);h.trigger("tagRemove",k.find("span").text())}if(j.keyCode==9){j.preventDefault()}});g.on("keyup","li input",function(n){n.preventDefault();$ul=g.find("ul");var j=i.next(),m=j.hasClass("autofill-bg"),k=$ul.find("li.tags-input");i.width(i.val().length*(f));if(m){j.width(j.val().length*(f));i.width(j.val().length*(f));if(j.width()<c.maxSize){j.width(c.maxSize)}var l=j.data().data}if(i.width()<c.maxSize){i.width(c.maxSize)}if(!!~[9,188,13].indexOf(n.keyCode)){var p=i.val().replace(",","");var o=true;if(c.requireData&&m){if(!~l.indexOf(p)){o=false;i.val("")}}if(c.unique){if(!!~h.val().split(",").indexOf(p)){o=false;i.val("");j.val("")}}if(c.maxTags){if(h.val().split(",").length==c.maxTags){o=false;i.val("");j.val("")}}if(p&&o){k.before("<li class='tag'><span>"+p+"</span><a href='#'>x</a></li>");i.val("");if(m){j.val("")}d(h);h.trigger("tagAdd",p)}}})})}})(jQuery);