<!DOCTYPE html>
<html>
	<head>
		<title>.:.</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<style>
			#myDIV
			{
				width: 500px;
				height: 500px;
				background-color: lightgray;
				background-repeat: no-repeat;
				background-position: center center;
				background-size: contain;
			}
		</style>
		
	</head>
	<body>
		<div id='myDIV'>
		</div>
		
		<br>
		
		<button onclick='zoomIn()'> + </button>
		<button onclick='zoomOut()'> - </button>
		
		<br>
		<br>

		<button onclick='left()'> left </button>
		<button onclick='top()'> top </button>
		<button onclick='right()'> right </button>
		<button onclick='bottom()'> bottom </button>
		

		<script>
			var backgroundImageUrl = 'https://i.picsum.photos/id/634/2000/1000.jpg';
			var myDIV = null;
			var bgWidth = 0, bgHeight = 0;
			var myDivWidth = 500, myDivHeight = 500;
			var zoomStep = 5;
			var bgPosX = 0;
			var bgPosY = 0;
			
			var img = new Image();
			img.onload = function() {
				bgHeight = img.height;
				bgWidth  = img.width;
				init();
			}
			img.src = backgroundImageUrl;

			function init()
			{
				myDIV = document.getElementById("myDIV");
				myDIV.style.backgroundImage = "url('" + backgroundImageUrl + "')";
				console.log('from init()', myDIV);
			
				centerImage();
				
				bgPosX = -(bgWidth - myDivWidth)/2;
				bgPosY = -(bgHeight - myDivHeight)/2;
				
				myDIV.addEventListener('wheel', onWheel);
				myDIV.addEventListener('mousedown', draggable);
			} 
			
			function centerImage()
			{
				let weight = 0;
				if(bgWidth > bgHeight)
				{
					weight = bgWidth / myDivWidth;
					bgWidth = myDivWidth;
					bgHeight = bgHeight / weight;
				} else
				{
					weight = bgHeight / myDivWidth;
					bgHeight = myDivWidth;
					bgWidth = bgWidth / weight;
				}
			}
			
			
			function zoomIn()
			{
				__zoom(zoomStep);
			}
			
			function zoomOut()
			{
				__zoom(-zoomStep);
			}
			
			function __zoom(weight)
			{
				bgWidth = bgWidth + (bgWidth * weight)/100;
				bgHeight = bgHeight + (bgHeight * weight)/100;
				
				//console.log('bgWidth: ' + bgWidth + ', bgHeight: ' + bgHeight + ', weight: ' + weight);
				//console.log('bgPosX: ' + bgPosX + ', bgPosY: ' + bgPosY);

				myDIV.style.backgroundSize = bgWidth + "px " + bgHeight + "px";
				//myDIV.style.backgroundPosition = bgPosX + 'px ' + bgPosY + 'px';
				myDIV.style.backgroundPosition = 'center center';
			}
			
			function onWheel(e)
			{
				e.preventDefault();
				//console.log('onWheel()', e);
				if (e.deltaY)
				{
					deltaY = e.deltaY;
				} else if (e.wheelDelta) 
				{
					deltaY = -e.wheelDelta;
				}
				
				if(deltaY > 0)
				{
					var weight = -zoomStep;
				} else
				{
					var weight = zoomStep;
				}
				
				var rect = myDIV.getBoundingClientRect();
				var offsetX = e.pageX - bgPosX;
				var offsetY = e.pageY - bgPosY;
				
				
				offsetX = offsetX / bgWidth;
				offsetY = offsetY / bgHeight;
				
				bgPosX = bgPosX - (bgWidth * weight * offsetX) / 100;
				bgPosY = bgPosY - (bgHeight * weight * offsetY) / 100;
				
				
				//console.log(rect);
				//console.log('e.pageX: ' + e.pageX + ', rect.left: ' + rect.left+ ', bgPosX: ' + bgPosX);


				bgWidth = bgWidth + (bgWidth * weight) / 100;
				bgHeight = bgHeight + (bgHeight * weight) / 100;

				myDIV.style.backgroundSize = bgWidth + "px " + bgHeight + "px";
				myDIV.style.backgroundPosition = bgPosX + 'px ' + bgPosY + 'px';

				
				
			}
			
			function draggable(e)
			{
				e.preventDefault();
				previousEvent = e;
				document.addEventListener('mousemove', drag);
				document.addEventListener('mouseup', removeDrag);
			}
			
			function drag(e) {
				e.preventDefault();
				bgPosX += (e.pageX - previousEvent.pageX);
				bgPosY += (e.pageY - previousEvent.pageY);
				previousEvent = e;
				
				myDIV.style.backgroundSize = bgWidth + "px " + bgHeight + "px";
				myDIV.style.backgroundPosition = bgPosX + 'px ' + bgPosY + 'px';
				
			}
			
			function removeDrag() {
				document.removeEventListener('mouseup', removeDrag);
				document.removeEventListener('mousemove', drag);
			}
			
			
			function getMeta(url)
			{   
				var img = new Image();
				img.addEventListener("load", function(){
					alert( this.naturalWidth +' '+ this.naturalHeight );
				});
				img.src = url;
			}
			//getMeta('http://wallpaperswide.com/download/straight_road_2-wallpaper-5472x1824.jpg');
			</script>	
		
	</body>
</html>